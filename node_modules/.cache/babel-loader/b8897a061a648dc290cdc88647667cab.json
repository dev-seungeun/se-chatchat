{"ast":null,"code":"import { database, database_set, database_ref, database_on_value, startAt } from \"../services/firebase\";\nimport { onValue, onChildAdded, onChildChanged, onChildRemoved } from \"firebase/database\";\nexport function getRooms(callback) {\n  // const roomRef = database_ref(database, \"chats\");\n  const roomRef = query(database_ref(database, 'chats/'), startAt('timestamp'));\n  onValue(roomRef, snapshot => {\n    callback(snapshot.val());\n  });\n}\nexport function sendChat(roomName, data) {\n  return database_set(database_ref(database, 'chats/' + roomName + \"/\" + data.timestamp), {\n    message: data.message,\n    timestamp: data.timestamp,\n    email: data.email,\n    uid: data.uid\n  });\n}\nexport function getChats(roomName) {\n  let chats = [];\n  const date = new Date();\n  const today = new Date(date.getFullYear(), date.getMonth(), date.getDate(), 0, 0, 0, 0);\n  const chatRef = database_ref(database, \"chats/\" + roomName).startAt(today);\n  onValue(chatRef, snapshot => {\n    snapshot.forEach(row => {\n      chats.push(row.val());\n    });\n  });\n  return chats;\n}\nexport const chatOnValue = onValue;\nexport const chatOnChildAdded = onChildAdded;\nexport const chatOnChildChanged = onChildChanged;\nexport const chatOnChildRemoved = onChildRemoved;","map":{"version":3,"sources":["C:/workspaces/atom_workspace/sesh-chatchat/src/helpers/database.js"],"names":["database","database_set","database_ref","database_on_value","startAt","onValue","onChildAdded","onChildChanged","onChildRemoved","getRooms","callback","roomRef","query","snapshot","val","sendChat","roomName","data","timestamp","message","email","uid","getChats","chats","date","Date","today","getFullYear","getMonth","getDate","chatRef","forEach","row","push","chatOnValue","chatOnChildAdded","chatOnChildChanged","chatOnChildRemoved"],"mappings":"AAAA,SAASA,QAAT,EAAmBC,YAAnB,EAAiCC,YAAjC,EAA+CC,iBAA/C,EAAkEC,OAAlE,QAAiF,sBAAjF;AACA,SAASC,OAAT,EAAkBC,YAAlB,EAAgCC,cAAhC,EAAgDC,cAAhD,QAAsE,mBAAtE;AAEA,OAAO,SAASC,QAAT,CAAkBC,QAAlB,EAA4B;AACnC;AACE,QAAMC,OAAO,GAAGC,KAAK,CAACV,YAAY,CAACF,QAAD,EAAW,QAAX,CAAb,EAAmCI,OAAO,CAAC,WAAD,CAA1C,CAArB;AACAC,EAAAA,OAAO,CAACM,OAAD,EAAWE,QAAD,IAAc;AAC7BH,IAAAA,QAAQ,CAACG,QAAQ,CAACC,GAAT,EAAD,CAAR;AACD,GAFM,CAAP;AAGD;AAED,OAAO,SAASC,QAAT,CAAkBC,QAAlB,EAA4BC,IAA5B,EAAkC;AACvC,SAAOhB,YAAY,CAACC,YAAY,CAACF,QAAD,EAAW,WAASgB,QAAT,GAAkB,GAAlB,GAAsBC,IAAI,CAACC,SAAtC,CAAb,EAA+D;AAChFC,IAAAA,OAAO,EAAEF,IAAI,CAACE,OADkE;AAEhFD,IAAAA,SAAS,EAAED,IAAI,CAACC,SAFgE;AAGhFE,IAAAA,KAAK,EAAEH,IAAI,CAACG,KAHoE;AAIhFC,IAAAA,GAAG,EAAEJ,IAAI,CAACI;AAJsE,GAA/D,CAAnB;AAMD;AAED,OAAO,SAASC,QAAT,CAAkBN,QAAlB,EAA4B;AACjC,MAAIO,KAAK,GAAG,EAAZ;AACA,QAAMC,IAAI,GAAG,IAAIC,IAAJ,EAAb;AACA,QAAMC,KAAK,GAAG,IAAID,IAAJ,CAASD,IAAI,CAACG,WAAL,EAAT,EAA6BH,IAAI,CAACI,QAAL,EAA7B,EAA8CJ,IAAI,CAACK,OAAL,EAA9C,EAA8D,CAA9D,EAAiE,CAAjE,EAAoE,CAApE,EAAuE,CAAvE,CAAd;AACA,QAAMC,OAAO,GAAG5B,YAAY,CAACF,QAAD,EAAW,WAASgB,QAApB,CAAZ,CAA0CZ,OAA1C,CAAkDsB,KAAlD,CAAhB;AACArB,EAAAA,OAAO,CAACyB,OAAD,EAAWjB,QAAD,IAAc;AAC7BA,IAAAA,QAAQ,CAACkB,OAAT,CAAkBC,GAAD,IAAS;AACxBT,MAAAA,KAAK,CAACU,IAAN,CAAWD,GAAG,CAAClB,GAAJ,EAAX;AACD,KAFD;AAGD,GAJM,CAAP;AAKA,SAAOS,KAAP;AACD;AAED,OAAO,MAAMW,WAAW,GAAG7B,OAApB;AACP,OAAO,MAAM8B,gBAAgB,GAAG7B,YAAzB;AACP,OAAO,MAAM8B,kBAAkB,GAAG7B,cAA3B;AACP,OAAO,MAAM8B,kBAAkB,GAAG7B,cAA3B","sourcesContent":["import { database, database_set, database_ref, database_on_value, startAt } from \"../services/firebase\";\r\nimport { onValue, onChildAdded, onChildChanged, onChildRemoved } from \"firebase/database\";\r\n\r\nexport function getRooms(callback) {\r\n// const roomRef = database_ref(database, \"chats\");\r\n  const roomRef = query(database_ref(database, 'chats/'), startAt('timestamp'));\r\n  onValue(roomRef, (snapshot) => {\r\n    callback(snapshot.val());\r\n  });\r\n}\r\n\r\nexport function sendChat(roomName, data) {\r\n  return database_set(database_ref(database, 'chats/'+roomName+\"/\"+data.timestamp), {\r\n    message: data.message,\r\n    timestamp: data.timestamp,\r\n    email: data.email,\r\n    uid: data.uid\r\n  });\r\n}\r\n\r\nexport function getChats(roomName) {\r\n  let chats = [];\r\n  const date = new Date();\r\n  const today = new Date(date.getFullYear(), date.getMonth(), date.getDate(), 0, 0, 0, 0);\r\n  const chatRef = database_ref(database, \"chats/\"+roomName).startAt(today);\r\n  onValue(chatRef, (snapshot) => {\r\n    snapshot.forEach((row) => {\r\n      chats.push(row.val());\r\n    });\r\n  });\r\n  return chats;\r\n}\r\n\r\nexport const chatOnValue = onValue;\r\nexport const chatOnChildAdded = onChildAdded;\r\nexport const chatOnChildChanged = onChildChanged;\r\nexport const chatOnChildRemoved = onChildRemoved;\r\n"]},"metadata":{},"sourceType":"module"}