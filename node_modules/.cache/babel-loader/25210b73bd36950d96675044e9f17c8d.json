{"ast":null,"code":"import{database,database_set,database_ref,database_on_value}from\"../services/firebase\";import{onValue,onChildAdded,onChildChanged,onChildRemoved,query,orderByKey,orderByChild,limitToLast,startAt}from\"firebase/database\";export function getRooms(callback){var roomRef=database_ref(database,\"chats\");onValue(roomRef,function(snapshot){callback(snapshot.val());});}export function sendChat(roomName,data){return database_set(database_ref(database,'chats/'+roomName+\"/\"+data.timestamp),{message:data.message,timestamp:data.timestamp,email:data.email,uid:data.uid});}export function getChats(roomName){var chats=[];var date=new Date();var today=new Date(date.getFullYear(),date.getMonth(),date.getDate(),0,0,0,0).getTime();// console.log(today);\nvar chatRef=query(database_ref(database,'chats/'+roomName),orderByKey(),startAt(today.toString()),limitToLast(100));// const chatRef = database_ref(database, \"chats/\"+roomName);\nonValue(chatRef,function(snapshot){snapshot.forEach(function(row){chats.push(row.val());});});return chats;}export var chatOnValue=onValue;export var chatOnChildAdded=onChildAdded;export var chatOnChildChanged=onChildChanged;export var chatOnChildRemoved=onChildRemoved;","map":{"version":3,"sources":["C:/workspaces/atom_workspace/sesh-chatchat/src/helpers/database.js"],"names":["database","database_set","database_ref","database_on_value","onValue","onChildAdded","onChildChanged","onChildRemoved","query","orderByKey","orderByChild","limitToLast","startAt","getRooms","callback","roomRef","snapshot","val","sendChat","roomName","data","timestamp","message","email","uid","getChats","chats","date","Date","today","getFullYear","getMonth","getDate","getTime","chatRef","toString","forEach","row","push","chatOnValue","chatOnChildAdded","chatOnChildChanged","chatOnChildRemoved"],"mappings":"AAAA,OAASA,QAAT,CAAmBC,YAAnB,CAAiCC,YAAjC,CAA+CC,iBAA/C,KAAwE,sBAAxE,CACA,OAASC,OAAT,CAAkBC,YAAlB,CAAgCC,cAAhC,CAAgDC,cAAhD,CAAgEC,KAAhE,CAAuEC,UAAvE,CAAmFC,YAAnF,CAAiGC,WAAjG,CAA8GC,OAA9G,KAA6H,mBAA7H,CAEA,MAAO,SAASC,CAAAA,QAAT,CAAkBC,QAAlB,CAA4B,CACjC,GAAMC,CAAAA,OAAO,CAAGb,YAAY,CAACF,QAAD,CAAW,OAAX,CAA5B,CACAI,OAAO,CAACW,OAAD,CAAU,SAACC,QAAD,CAAc,CAC7BF,QAAQ,CAACE,QAAQ,CAACC,GAAT,EAAD,CAAR,CACD,CAFM,CAAP,CAGD,CAED,MAAO,SAASC,CAAAA,QAAT,CAAkBC,QAAlB,CAA4BC,IAA5B,CAAkC,CACvC,MAAOnB,CAAAA,YAAY,CAACC,YAAY,CAACF,QAAD,CAAW,SAASmB,QAAT,CAAkB,GAAlB,CAAsBC,IAAI,CAACC,SAAtC,CAAb,CAA+D,CAChFC,OAAO,CAAEF,IAAI,CAACE,OADkE,CAEhFD,SAAS,CAAED,IAAI,CAACC,SAFgE,CAGhFE,KAAK,CAAEH,IAAI,CAACG,KAHoE,CAIhFC,GAAG,CAAEJ,IAAI,CAACI,GAJsE,CAA/D,CAAnB,CAMD,CAED,MAAO,SAASC,CAAAA,QAAT,CAAkBN,QAAlB,CAA4B,CACjC,GAAIO,CAAAA,KAAK,CAAG,EAAZ,CACA,GAAMC,CAAAA,IAAI,CAAG,GAAIC,CAAAA,IAAJ,EAAb,CACA,GAAMC,CAAAA,KAAK,CAAI,GAAID,CAAAA,IAAJ,CAASD,IAAI,CAACG,WAAL,EAAT,CAA6BH,IAAI,CAACI,QAAL,EAA7B,CAA8CJ,IAAI,CAACK,OAAL,EAA9C,CAA8D,CAA9D,CAAiE,CAAjE,CAAoE,CAApE,CAAuE,CAAvE,CAAD,CAA4EC,OAA5E,EAAd,CACA;AACA,GAAMC,CAAAA,OAAO,CAAG1B,KAAK,CAACN,YAAY,CAACF,QAAD,CAAW,SAASmB,QAApB,CAAb,CAA4CV,UAAU,EAAtD,CAA0DG,OAAO,CAACiB,KAAK,CAACM,QAAN,EAAD,CAAjE,CAAqFxB,WAAW,CAAC,GAAD,CAAhG,CAArB,CACA;AACAP,OAAO,CAAC8B,OAAD,CAAU,SAAClB,QAAD,CAAc,CAC7BA,QAAQ,CAACoB,OAAT,CAAiB,SAACC,GAAD,CAAS,CACxBX,KAAK,CAACY,IAAN,CAAWD,GAAG,CAACpB,GAAJ,EAAX,EACD,CAFD,EAGD,CAJM,CAAP,CAKA,MAAOS,CAAAA,KAAP,CACD,CAED,MAAO,IAAMa,CAAAA,WAAW,CAAGnC,OAApB,CACP,MAAO,IAAMoC,CAAAA,gBAAgB,CAAGnC,YAAzB,CACP,MAAO,IAAMoC,CAAAA,kBAAkB,CAAGnC,cAA3B,CACP,MAAO,IAAMoC,CAAAA,kBAAkB,CAAGnC,cAA3B","sourcesContent":["import { database, database_set, database_ref, database_on_value } from \"../services/firebase\";\r\nimport { onValue, onChildAdded, onChildChanged, onChildRemoved, query, orderByKey, orderByChild, limitToLast, startAt } from \"firebase/database\";\r\n\r\nexport function getRooms(callback) {\r\n  const roomRef = database_ref(database, \"chats\");\r\n  onValue(roomRef, (snapshot) => {\r\n    callback(snapshot.val());\r\n  });\r\n}\r\n\r\nexport function sendChat(roomName, data) {\r\n  return database_set(database_ref(database, 'chats/'+roomName+\"/\"+data.timestamp), {\r\n    message: data.message,\r\n    timestamp: data.timestamp,\r\n    email: data.email,\r\n    uid: data.uid\r\n  });\r\n}\r\n\r\nexport function getChats(roomName) {\r\n  let chats = [];\r\n  const date = new Date();\r\n  const today = (new Date(date.getFullYear(), date.getMonth(), date.getDate(), 0, 0, 0, 0)).getTime();\r\n  // console.log(today);\r\n  const chatRef = query(database_ref(database, 'chats/'+roomName), orderByKey(), startAt(today.toString()), limitToLast(100));\r\n  // const chatRef = database_ref(database, \"chats/\"+roomName);\r\n  onValue(chatRef, (snapshot) => {\r\n    snapshot.forEach((row) => {\r\n      chats.push(row.val());\r\n    });\r\n  });\r\n  return chats;\r\n}\r\n\r\nexport const chatOnValue = onValue;\r\nexport const chatOnChildAdded = onChildAdded;\r\nexport const chatOnChildChanged = onChildChanged;\r\nexport const chatOnChildRemoved = onChildRemoved;\r\n"]},"metadata":{},"sourceType":"module"}